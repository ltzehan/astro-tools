(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     12404,        282]
NotebookOptionsPosition[     12101,        269]
NotebookOutlinePosition[     12449,        284]
CellTagsIndexPosition[     12406,        281]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", "0.15"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Omega]", "=", 
    FractionBox[
     RowBox[{"2", " ", "Pi"}], "365"]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"celestialSphere", "[", 
     RowBox[{"t_", ",", "\[Epsilon]_", ",", "vp_"}], "]"}], ":=", 
    RowBox[{"Graphics3D", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RGBColor", "[", 
         RowBox[{".75", ",", ".75", ",", ".75"}], "]"}], ",", 
        RowBox[{"Opacity", "[", ".75", "]"}], ",", 
        RowBox[{"Sphere", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", "R"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"mean", " ", "sun"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"EdgeForm", "[", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Black"}], "}"}], "]"}], ",", 
        RowBox[{"FaceForm", "[", "Transparent", "]"}], ",", 
        RowBox[{"Cylinder", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0.01"}], "}"}]}], "}"}], ",", "R"}],
          "]"}], ",", "\[IndentingNewLine]", "Black", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"Sphere", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"R", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"\[Omega]", " ", "t"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"-", "R"}], "  ", 
             RowBox[{"Cos", "[", 
              RowBox[{"\[Omega]", " ", "t"}], "]"}]}], ",", "0"}], "}"}], ",",
           "r"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"actual", " ", "sun"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"EdgeForm", "[", 
         RowBox[{"{", 
          RowBox[{"Thick", ",", "Red"}], "}"}], "]"}], ",", 
        RowBox[{"FaceForm", "[", "Transparent", "]"}], ",", 
        RowBox[{"Rotate", "[", 
         RowBox[{
          RowBox[{"Cylinder", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0.01"}], "}"}]}], "}"}], ",", 
            "R"}], "]"}], ",", 
          RowBox[{"-", "\[Epsilon]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "Red", ",", 
        RowBox[{"Opacity", "[", "1", "]"}], ",", 
        RowBox[{"Rotate", "[", 
         RowBox[{
          RowBox[{"Sphere", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"R", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"\[Omega]", " ", "t"}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"-", "R"}], "  ", 
               RowBox[{"Cos", "[", 
                RowBox[{"\[Omega]", " ", "t"}], "]"}]}], ",", "0"}], "}"}], 
            ",", "r"}], "]"}], ",", 
          RowBox[{"-", "\[Epsilon]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Boxed", "\[Rule]", "False"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", 
       RowBox[{"1.1", "R"}]}], ",", 
      RowBox[{"AspectRatio", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"ViewPoint", "\[Rule]", "vp"}], ",", 
      RowBox[{"ViewAngle", "\[Rule]", 
       RowBox[{"15", "Degree"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"Lighting", "\[Rule]", "\"\<Neutral\>\""}], ",", 
      RowBox[{"ImageSize", "\[Rule]", "Medium"}], ",", 
      RowBox[{"SphericalRegion", "\[Rule]", "True"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{"isDeployed", ",", 
       RowBox[{"Deploy", "@", "#"}], ",", "#"}], "]"}], "&"}], "@", 
    "\[IndentingNewLine]", 
    RowBox[{"Row", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"celestialSphere", "[", 
        RowBox[{"t", ",", "\[Epsilon]", ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "5"}], ",", "1"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"celestialSphere", "[", 
        RowBox[{"t", ",", "\[Epsilon]", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"R", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"\[Omega]", " ", "t"}], "]"}]}], ",", 
           RowBox[{
            RowBox[{"-", "R"}], "  ", 
            RowBox[{"Cos", "[", 
             RowBox[{"\[Omega]", " ", "t"}], "]"}]}], ",", "0"}], "}"}]}], 
        "]"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Grid", "[", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Control", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Epsilon]", ",", 
             RowBox[{"23.5", "Degree"}]}], "}"}], ",", 
           RowBox[{"0", "Degree"}], ",", 
           RowBox[{"90", "Degree"}], ",", 
           RowBox[{"0.1", "Degree"}]}], "}"}], "]"}], ",", 
        RowBox[{"Spacer", "[", "50", "]"}], ",", 
        RowBox[{"Framed", "[", 
         RowBox[{
          RowBox[{"Control", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"isDeployed", ",", "True", ",", "\"\<Locked\>\""}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"True", ",", "False"}], "}"}]}], "}"}], "]"}], ",", 
          RowBox[{"FrameStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Gray", ",", "Thin"}], "]"}]}], ",", 
          RowBox[{"FrameMargins", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"15", ",", "15"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"5", ",", "5"}], "}"}]}], "}"}]}]}], "]"}]}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"Control", "[", 
        RowBox[{"{", 
         RowBox[{"t", ",", "0", ",", "365", ",", "1", ",", 
          RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], "]"}], 
       "}"}]}], "\[IndentingNewLine]", "}"}], "]"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7511104606544614`*^9, 3.751110479286337*^9}, {
   3.7511105735969033`*^9, 3.75111080055748*^9}, {3.7511110335662456`*^9, 
   3.7511110552882023`*^9}, {3.7511111923807287`*^9, 
   3.7511113500614047`*^9}, {3.7511113878375664`*^9, 3.75111153471672*^9}, {
   3.751111572189768*^9, 3.751111717646982*^9}, {3.7511120365816884`*^9, 
   3.751112090798638*^9}, {3.751112134820861*^9, 3.7511121397008047`*^9}, {
   3.7511121747720337`*^9, 3.7511122637390366`*^9}, {3.7511445473472385`*^9, 
   3.7511446252388763`*^9}, {3.7511447207363834`*^9, 
   3.7511447732149563`*^9}, {3.7511448499816055`*^9, 3.751144904714182*^9}, {
   3.7511449551711845`*^9, 3.7511450738795977`*^9}, {3.7511452296023397`*^9, 
   3.751145345460232*^9}, {3.751145379337844*^9, 3.75114538517764*^9}, {
   3.751145463894023*^9, 3.751145470939129*^9}, {3.7511455037862606`*^9, 
   3.7511455108678474`*^9}, {3.7511455444332113`*^9, 
   3.7511455470950174`*^9}, {3.751145598640607*^9, 3.7511456156238327`*^9}, {
   3.7511456622133446`*^9, 3.7511456998963366`*^9}, {3.7511457310838947`*^9, 
   3.7511458698119407`*^9}, {3.7511459216394234`*^9, 
   3.7511459268613243`*^9}, {3.7511459771444616`*^9, 
   3.7511462703596835`*^9}, {3.7511463018032627`*^9, 
   3.7511463818005347`*^9}, {3.7511465123459997`*^9, 3.751146518826267*^9}, {
   3.751146549197925*^9, 3.7511465774141846`*^9}, 3.751146650623199*^9, {
   3.75114668604418*^9, 3.7511466937856436`*^9}, {3.751146833038154*^9, 
   3.75114684063993*^9}, {3.7511468884740973`*^9, 3.7511469065169086`*^9}, {
   3.751146975535536*^9, 3.751146990410137*^9}, {3.7511471920922823`*^9, 
   3.7511472550024786`*^9}, {3.7511745946852455`*^9, 
   3.7511746002036505`*^9}, {3.7511746320051785`*^9, 3.751174633054522*^9}, {
   3.751174664429758*^9, 3.7511746660771456`*^9}, {3.7511747251489363`*^9, 
   3.7511748285407887`*^9}, {3.7511748786695013`*^9, 
   3.7511750915167246`*^9}, {3.7511751390611115`*^9, 3.751175181308488*^9}, {
   3.7511754355572634`*^9, 3.751175464581827*^9}, {3.7511755207970657`*^9, 
   3.7511755889323874`*^9}, {3.7511756810948277`*^9, 3.7511758160775414`*^9}, 
   3.751175953214381*^9, {3.7511760502760725`*^9, 3.7511760532760534`*^9}, {
   3.751177285061703*^9, 3.7511773627175975`*^9}, {3.751177396852653*^9, 
   3.751177415693013*^9}, {3.7511774515811033`*^9, 3.7511774516777763`*^9}, {
   3.7511774878148365`*^9, 3.751177540429073*^9}, {3.751177645283455*^9, 
   3.75117764686301*^9}, {3.751177686020904*^9, 3.7511777333728805`*^9}, {
   3.751177779925003*^9, 3.7511778408217645`*^9}, {3.751177929036934*^9, 
   3.7511779600690823`*^9}, {3.751178069918171*^9, 3.7511780865408106`*^9}, {
   3.751178165805509*^9, 3.751178171221266*^9}, {3.751178382516895*^9, 
   3.7511784757334175`*^9}, {3.7511785507587223`*^9, 3.751178567518326*^9}, {
   3.7511785993940663`*^9, 3.751178604228841*^9}, {3.7511786443667984`*^9, 
   3.7511786454682183`*^9}, {3.751178731124754*^9, 3.7511787635866303`*^9}, {
   3.751178982564728*^9, 3.751178993308848*^9}, {3.75117903848357*^9, 
   3.751179059078869*^9}, {3.7511791896526365`*^9, 3.751179266635565*^9}, {
   3.7511793896042604`*^9, 3.751179422310152*^9}, {3.7511795928452063`*^9, 
   3.7511796178283205`*^9}, 3.7511796649816103`*^9, {3.7511797214836197`*^9, 
   3.751179775517093*^9}, {3.7511798173650246`*^9, 3.751179818525872*^9}, {
   3.7511798487086763`*^9, 3.751179916613573*^9}, {3.751179957965111*^9, 
   3.751179979420719*^9}, {3.7511801731029835`*^9, 3.7511801895228214`*^9}, {
   3.751180268868854*^9, 3.751180284996251*^9}, {3.7511803190058956`*^9, 
   3.75118032981361*^9}, {3.751180532521839*^9, 3.751180606788414*^9}, {
   3.75118107179101*^9, 3.751181153797125*^9}, {3.7511811983411565`*^9, 
   3.751181203884805*^9}, {3.751181238205576*^9, 3.7511812413092833`*^9}, {
   3.751181425630458*^9, 3.751181443980489*^9}, {3.751181549981251*^9, 
   3.7511815581649256`*^9}, {3.751181644869419*^9, 3.751181679140996*^9}, {
   3.7511817460903006`*^9, 3.751181890852142*^9}, {3.7511819257086535`*^9, 
   3.751181961414136*^9}, 3.751185861253473*^9, {3.751185986340568*^9, 
   3.751186024398881*^9}, {3.7511860549112635`*^9, 3.7511860662054186`*^9}, {
   3.7511861261433935`*^9, 3.751186245863901*^9}, {3.7511863605096703`*^9, 
   3.7511863656211605`*^9}, {3.7511865121748705`*^9, 
   3.7511867081359076`*^9}, {3.751186899823473*^9, 
   3.751186970262233*^9}},ExpressionUUID->"0c717f5e-14ad-4410-a543-\
526931114009"]
},
WindowSize->{1280, 677},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 11539, 247, 646, "Input",ExpressionUUID->"0c717f5e-14ad-4410-a543-526931114009"]
}
]
*)

